# HighwayRoadMap
A paradigm for robot motion planning based on parameterizations of the free space

## Description
We develop a motion planning algorithm based on the closed-form Minkowski sum and difference between ellipsoid and general obstacle (bounded as a convex differentiable surface, i.e. superquadrics). Full algorithm is developed in Matlab and benchmark code is written in C++. The algorithms for both SE(2) and SE(3) rigid body planning problems have been developed and compared with sampled-based planners from OMPL. The benchmark results show that our proposed method outperforms the sample-based planners (i.e. PRM, RRT, RRT-Connect, etc) especially in the narrow-passage problem.

## Dependencies
- [OMPL](https://ompl.kavrakilab.org/installation.html): Open Motion Planning Library for sample-based planners
- [FCL](https://github.com/flexible-collision-library/fcl): Flexible Collision Library for collision detection
- [CCD](https://github.com/danfis/libccd): Required dependency for FCL
- [CGAL](https://www.cgal.org/): Mesh generation as a pre-process
- GMP: Required dependency for CGAL
- Eigen
- [Boost](https://www.boost.org/)
- [cmake-format] 
    ```
    sudo pip3 install cmake-format==0.4.5
    ```
- [clang-format]
    ```
    sudo apt install clang

    ```

## Testing Instructions
### Generate configuration files
Configuration files are all stored in "/config" folder, including (3D cases as an example) "arena_config_3d.csv", "obs_config_3d.csv". "robot_config_3d.csv" and "endPts_3d.csv". They are generated by Matlab scripts "/matlab/test/robotConfig_3D.m".

### Running tests
Testing files are located in "/test" folder:
- 2D case (single body): "/test/test.cpp"
- 3D case (sinlge body): "/test/test_highway3d.cpp"
- 3D case (multi body): "/test/test_hrm3d_multibody.cpp"

### Benchmarks
Benchmark files are stored in "/benchmark" folder:
- 3D OMPL planners: "/benchmark/benchmark_3d_ompl.cpp", 
- 3D Highway single body: "/benchmark/benchmark_3d_highway.cpp"
- 3D Highway multi body: "/benchmark/benchmark_3d_hrm_multibody.cpp"
- 3D Highway multi body with adaptive C-layers updates: "/benchmark/benchmark_3d_hrm_multi_adaptive.cpp"

### Visualizations
After running test or benchmark files, parameters for visualization will be generated in the "/bin" folder. Visualization scripts are all in Matlab:
- Plot 2D results: "/matlab/tests/plotShape.m"
- Plot 3D single body results: "/matlab/tests/plotShape_3D.m"
- Plot 3D multi body results: "/matlab/tests/plotShape_3D_MultiBody.m"
- Plot 3D OMPL planners results: "/matlab/tests/plotShape_ompl_3D.m"

## Status
### Highway RoadMap planner
1. SE(2) single rigid body finished: 
- Fixed number of layers and sweep lines.
- Layer connections using KC ("src/planners/HighwayRoadMap.cpp") and TFE ("src/planners/HighwayRoadMap2d.cpp").

2. SE(3) single/multi rigid body in progress:
- Single body ("src/planners/HighwayRoadMap3d.cpp"): fixed number of layers and sweep lines.
- Multi body: fixed ("src/planners/Hrm3DMultiBody.cpp") / adaptive ("src/planners/Hrm3DMultiBodyAdaptive.cpp") number of layers, fixed sweep lines.
- Layer connections using TFE.

### OMPL sampled-based planners
1. SE(2) single rigid body

2. SE(3) single/multi rigid body

## TODO
### Benchmark in different scenerios
- Sparse map
- Cluttered map
- Narrow passage with different window size

### Articulated body
1. Extend to multi-link articulated robot

### Demo
1. Verify the algorithm in real robot, i.e. project the NAO humanoid robot to the plane, and plan a trajectory.

## Related Papers
"Ruan, S., Ma, Q., Poblete, K.L., Yan, Y. and Chirikjian G.S., 2018, December. Path Planning for Ellipsoidal Robots and General Obstacles via Closed-Form Characterization of Minkowski Operations. WAFR 2018."

"Yan, Y., Ma, Q. and Chirikjian, G.S., 2016, October. Path Planning Based on Closed-Form Characterization of Collision-Free Configuration-Spaces for Ellipsoidal Bodies, Obstacles, and Environments. In Proc. Int. Workshop Robot Learn. Plan. (pp. 13-19)."

"Yan, Y. and Chirikjian, G.S., 2015. Closed-form characterization of the Minkowski sum and difference of two ellipsoids. Geometriae Dedicata, 177(1), pp.103-128."

"Ruan, S., Ding, J., Ma, Q. and Chirikjian, G.S., 2019. The Kinematics of Containment for N-Dimensional Ellipsoids. Journal of Mechanisms and Robotics, 11(4), p.041005."

"Ruan, S., Ding, J. and Chirikjian, G.S., 2018. Lower Bounds of the Allowable Motions of One N-Dimensional Ellipsoid Contained in Another. ASME IDETC 2018."

"Ma, Q. and Chirikjian, G.S., 2015, August. A Closed-Form Lower Bound on the Allowable Motion for an Ellipsoidal Body and Environment. ASME IDETC 2015."

"Chirikjian, G.S. and Yan, Y., 2014. The Kinematics of Containment. In Advances in Robot Kinematics (pp. 355-364). Springer International Publishing."

